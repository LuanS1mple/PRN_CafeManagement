@model CafeManagent.dto.request.CreateStaffRequest
@{
    ViewData["Title"] = "Thêm nhân viên";
    var roles = ViewBag.Roles as List<Microsoft.AspNetCore.Mvc.Rendering.SelectListItem> ?? new();
}

<link rel="stylesheet" href="~/css/StaffCreate.css" />

<div class="container profile-wrap">
    <h2>Thêm nhân viên mới</h2>

    <form asp-action="Create" asp-controller="StaffDirectory"
          method="post" enctype="multipart/form-data" class="profile-grid">
        @Html.AntiForgeryToken()

        <!-- LEFT: avatar -->
        <aside class="card left-card">
            <div class="avatar-wrap">
                <img id="avatarPreview" class="avatar-circle" src="/images/avatars/default.png" alt="Avatar preview" />
            </div>

            <label class="btn btn-upload" for="AvatarFile">
                <span class="icon-up">⌃</span> Tải ảnh lên
            </label>
            <input asp-for="AvatarFile" id="AvatarFile" accept="image/*" style="display:none" />
            <div class="label" style="margin-top:8px;">PNG/JPG/WEBP ≤ 2MB</div>
            <span asp-validation-for="AvatarFile" class="text-danger"></span>
        </aside>

        <!-- RIGHT: form fields -->
        <section class="card right-card">
            <h3>Thông tin</h3>

            <!-- TÓM TẮT LỖI (server + client) -->
            <div asp-validation-summary="ModelOnly" class="val-summary"></div>

            <div class="kv2" style="grid-template-columns:1fr 1fr;">

                <!-- Role -->
                <div class="kv2-row">
                    <div class="kv2-label">Role</div>
                    <div class="kv2-value">
                        <select asp-for="RoleId" asp-items="roles" class="input">
                            <option value="">— Chọn vai trò —</option>
                        </select>
                        <span asp-validation-for="RoleId" class="text-danger"></span>
                    </div>
                </div>

                <!-- Full name -->
                <div class="kv2-row">
                    <div class="kv2-label">Họ và tên</div>
                    <div class="kv2-value">
                        <input asp-for="FullName" class="input" maxlength="100" />
                        <span asp-validation-for="FullName" class="text-danger"></span>
                    </div>
                </div>

                <!-- Gender -->
                <div class="kv2-row">
                    <div class="kv2-label">Giới tính</div>
                    <div class="kv2-value">
                        <select asp-for="Gender" class="input">
                            <option value="">—</option>
                            <option value="true">Nam</option>
                            <option value="false">Nữ</option>
                        </select>
                        <span asp-validation-for="Gender" class="text-danger"></span>
                    </div>
                </div>

                <!-- BirthDate -->
                <div class="kv2-row">
                    <div class="kv2-label">Ngày sinh</div>
                    <div class="kv2-value">
                        <input asp-for="BirthDate" type="date" class="input" />
                        <span asp-validation-for="BirthDate" class="text-danger"></span>
                    </div>
                </div>

                <!-- Email -->
                <div class="kv2-row">
                    <div class="kv2-label">Email</div>
                    <div class="kv2-value">
                        <input asp-for="Email" type="email" class="input" maxlength="200" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>

                <!-- Phone -->
                <div class="kv2-row">
                    <div class="kv2-label">Điện thoại</div>
                    <div class="kv2-value">
                        <input asp-for="Phone" class="input" maxlength="9" placeholder="9 chữ số" />
                        <span asp-validation-for="Phone" class="text-danger"></span>
                    </div>
                </div>

                <!-- Address -->
                <div class="kv2-row" style="grid-column:1/-1">
                    <div class="kv2-label">Địa chỉ</div>
                    <div class="kv2-value">
                        <input asp-for="Address" class="input" maxlength="255" />
                        <span asp-validation-for="Address" class="text-danger"></span>
                    </div>
                </div>

                <!-- Username -->
                <div class="kv2-row">
                    <div class="kv2-label">Tên đăng nhập</div>
                    <div class="kv2-value">
                        <input asp-for="UserName" class="input" maxlength="50" />
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>
                </div>

                <!-- Position (HĐ) -->
                <div class="kv2-row">
                    <div class="kv2-label">Chức danh (HĐ)</div>
                    <div class="kv2-value">
                        <input asp-for="Position" class="input" maxlength="100" />
                        <span asp-validation-for="Position" class="text-danger"></span>
                    </div>
                </div>

                <!-- Base Salary -->
                <div class="kv2-row">
                    <div class="kv2-label">Lương cơ bản</div>
                    <div class="kv2-value">
                        <input asp-for="BaseSalary" type="number" class="input" min="0" step="0.01" />
                        <span asp-validation-for="BaseSalary" class="text-danger"></span>
                    </div>
                </div>

            </div>

            <div style="margin-top:12px;">
                <a class="btn secondary" asp-action="Index" asp-controller="StaffDirectory">Hủy</a>
                <button class="btn primary" type="submit">Tạo nhân viên</button>
            </div>
        </section>
    </form>
</div>

@section Scripts {
    <script>
        const fileInput = document.getElementById('AvatarFile');
        const avatar = document.getElementById('avatarPreview');
        if (fileInput && avatar) {
            fileInput.addEventListener('change', (e) => {
                const f = e.target.files && e.target.files[0];
                if (!f) return;
                const url = URL.createObjectURL(f);
                avatar.src = url;
            });
        }
    </script>
    <partial name="_ValidationScriptsPartial" />
}
