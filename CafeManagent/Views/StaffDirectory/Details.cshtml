@model CafeManagent.dto.response.StaffDetailDto
@{
    ViewData["Title"] = "Chi tiết nhân viên";

    // Map status -> class + text hiển thị
    string statusRaw = Model.Status?.Trim() ?? "";
    string statusClass = "";
    string dotClass = "";
    string statusText = statusRaw;

    switch (statusRaw.ToLowerInvariant())
    {
        case "đang làm việc":
        case "đang hoạt động":
        case "active":
            statusClass = "status-active";
            dotClass = "dot-green";
            statusText = "Đang làm việc";
            break;

        case "nghỉ việc":
        case "inactive":
            statusClass = "status-inactive";
            dotClass = "dot-red";
            statusText = "Nghỉ việc";
            break;

        case "nghỉ phép":
        case "leave":
            statusClass = "status-leave";
            dotClass = "dot-gray";
            statusText = "Nghỉ phép";
            break;

        default:
            statusClass = "status-unknown";
            dotClass = "dot-gray";
            statusText = string.IsNullOrWhiteSpace(statusText) ? "Không xác định" : statusText;
            break;
    }
}

<link rel="stylesheet" href="~/css/Profile.css" />
<link rel="stylesheet" href="~/css/StaffStatus.css" /> <!-- 👈 thêm dòng này -->

<div class="container profile-wrap">
    <a class="link" asp-action="Index">← Danh sách nhân viên</a>

    <div class="profile-grid">
        <!-- LEFT column -->
        <aside class="left-card">
            <div class="avatar-wrap">
                <img class="avatar-circle" src="@Model.AvatarUrl?v=@DateTimeOffset.UtcNow.Ticks" alt="Avatar of @Model.FullName" />
            </div>

            <div class="name">@Model.FullName</div>

            @if (!string.IsNullOrEmpty(Model.RoleName))
            {
                <div class="role-chip">@Model.RoleName</div>
            }

            <div class="pill @statusClass" style="justify-content:center;">
                <span class="status-dot @dotClass">●</span>
                <span>@statusText</span>
            </div>

            <!--<button class="btn-upload" disabled>
                <span class="icon-up">⇪</span>
                Cập nhật ảnh
            </button>-->
        </aside>

        <!-- RIGHT column -->
        <main class="right-card">
            <div class="tabs" role="tablist" aria-hidden="true" style="margin-bottom:16px;">
                <a class="tab active">Tổng quan</a>
                <a class="tab">Hoạt động</a>
            </div>

            <!-- PERSONAL INFO -->
            <h3>Thông tin cá nhân</h3>

            <div class="form-grid" style="margin-bottom:12px;">
                <div class="field">
                    <div class="label">Email</div>
                    <div class="ro-input" aria-readonly="true">
                        <input readonly value="@Model.Email" />
                    </div>
                </div>

                <div class="field">
                    <div class="label">Số điện thoại</div>
                    <div class="ro-input">
                        <input readonly value="@Model.Phone" />
                    </div>
                </div>

                <div class="field">
                    <div class="label">Username</div>
                    <div class="ro-input">
                        <input readonly value="@Model.UserName" />
                    </div>
                </div>

                <div class="field">
                    <div class="label">Giới tính</div>
                    <div class="ro-input">
                        <input readonly
                               value="@(Model.Gender == true ? "Nam" : Model.Gender == false ? "Nữ" : "Không xác định")" />
                    </div>
                </div>


                <div class="field">
                    <div class="label">Địa chỉ</div>
                    <div class="ro-input">
                        <input readonly value="@Model.Address" />
                    </div>
                </div>

                <div class="field">
                    <div class="label">Ngày sinh</div>
                    <div class="ro-input">
                        <input readonly value="@Model.BirthDate?.ToString("dd/MM/yyyy")" />
                    </div>
                </div>
            </div>

            <!-- WORK INFO -->
            <h3>Thông tin công việc</h3>

            <div class="kv2" style="margin-top:8px;">
                <div class="kv2-row">
                    <div class="kv2-label">Chức danh</div>
                    <div class="kv2-value"><div class="ro-pill">@Model.Title</div></div>
                </div>

                <div class="kv2-row">
                    <div class="kv2-label">Vai trò</div>
                    <div class="kv2-value"><div class="ro-pill">@Model.RoleName</div></div>
                </div>

                <div class="kv2-row">
                    <div class="kv2-label">Ngày vào làm</div>
                    <div class="kv2-value"><div class="ro-pill">@Model.JoinDate?.ToString("dd/MM/yyyy")</div></div>
                </div>

                <div class="kv2-row">
                    <div class="kv2-label">Ngày hết hạn</div>
                    <div class="kv2-value"><div class="ro-pill">@Model.ContractEndDate?.ToString("dd/MM/yyyy")</div></div>
                </div>
            </div>

            <div class="actions">
                <a class="btn primary" asp-controller="StaffDirectory" asp-action="Edit" asp-route-id="@Model.StaffId">
                    ✏️ Sửa thông tin
                </a>
                <a class="btn secondary" asp-controller="StaffDirectory" asp-action="Index">
                    ← Quay lại danh sách
                </a>
            </div>

        </main>
    </div>
</div>
