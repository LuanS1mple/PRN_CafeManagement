@model CafeManagent.Models.Attendance

<div class="container" style="min-height: 90vh; padding-top: 20px; padding-bottom: 20px;">

    <!-- Nút quay lại căn trái -->
    <div class="mb-3 text-start">
        <a asp-controller="WorkSchedule" asp-action="WorkScheduleToday"
           class="btn btn-secondary px-4 py-2 rounded-pill shadow-sm">
            <i class="bi bi-arrow-left-circle me-1"></i> Quay lại
        </a>
    </div>

    <!-- Card chính căn giữa -->
    <div class="d-flex justify-content-center align-items-center" style="min-height: calc(90vh - 60px);">
        <div class="card shadow-lg border-0 rounded-4 p-5 bg-white" style="max-width: 700px; width: 100%;">

            <div class="text-center mb-4">
                <i class="bi bi-calendar-check text-teal fs-1 mb-2"></i>
                <h3 class="fw-bold text-teal">Xác nhận điểm danh</h3>
                <p class="text-muted mb-0">Kiểm tra thông tin trước khi thực hiện Check-in / Check-out</p>
            </div>

            @if (Model == null)
            {
                    <div class="alert alert-warning text-center">
                        Không tìm thấy thông tin ca làm việc cho hôm nay.
                    </div>
            }
            else
            {
                    <!-- Thông tin ca làm -->
                    <div class="info-box mb-4">
                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-person-fill me-2 text-teal"></i>Nhân viên</span>
                            <span class="info-value">@Model.Staff?.FullName</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-clock-fill me-2 text-teal"></i>Ca làm</span>
                            <span class="info-value">@Model.Workshift?.ShiftName</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-hourglass-split me-2 text-teal"></i>Giờ làm</span>
                            <span class="info-value">
                            @Model.Workshift?.StartTime - @Model.Workshift?.EndTime
                            </span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-calendar-date me-2 text-teal"></i>Ngày làm</span>
                            <span class="info-value">@Model.Workdate?.ToString("dd/MM/yyyy")</span>
                        </div>
                    </div>

                    <!-- Thông tin chi tiết nhân viên -->
                    <div class="info-box mb-4">
                        <h5 class="fw-bold text-teal mb-3"><i class="bi bi-person-badge me-2"></i>Thông tin nhân viên</h5>

                        <div class="text-center mb-4">
                            <img src="@(!string.IsNullOrEmpty(Model.Staff?.Img) ? Model.Staff.Img : "/images/default-avatar.png")"
                                 alt="Ảnh nhân viên"
                                 class="rounded-circle shadow-sm border"
                                 style="width: 120px; height: 120px; object-fit: cover;">
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-envelope me-2 text-teal"></i>Email</span>
                            <span class="info-value">@Model.Staff?.Email</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-telephone me-2 text-teal"></i>Số điện thoại</span>
                            <span class="info-value">@Model.Staff?.Phone</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-gender-ambiguous me-2 text-teal"></i>Giới tính</span>
                            <span class="info-value">@(Model.Staff?.Gender == true ? "Nam" : "Nữ")</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-calendar-heart me-2 text-teal"></i>Ngày sinh</span>
                            <span class="info-value">@Model.Staff?.BirthDate?.ToString("dd/MM/yyyy")</span>
                        </div>

                        <div class="info-item">
                            <span class="info-label"><i class="bi bi-geo-alt me-2 text-teal"></i>Địa chỉ</span>
                            <span class="info-value">@Model.Staff?.Address</span>
                        </div>
                    </div>

                @if (TempData["success"] != null)
                {
                            <div class="alert alert-success">@TempData["success"]</div>
                }
                @if (TempData["error"] != null)
                {
                            <div class="alert alert-danger">@TempData["error"]</div>
                }

                    <!-- Nút Check-in / Check-out -->
                    <div class="d-flex justify-content-center gap-4 mt-4">
                    @if (Model.Status == 1 || Model.Status == null)
                    {
                                <!-- Chưa check-in -->
                                <form method="post" asp-action="CheckIn" asp-controller="Attendance">
                                    <input type="hidden" name="staffId" value="@Model.StaffId" />
                                    <input type="hidden" name="shiftId" value="@Model.ShiftId" />
                                    <input type="hidden" name="workshiftId" value="@Model.WorkshiftId" />
                                    <input type="hidden" name="date" value="@Model.Workdate" />
                                    <button class="btn btn-teal px-4 py-2 rounded-pill shadow-sm" type="submit">
                                        <i class="bi bi-box-arrow-in-right me-1"></i> Check-In
                                    </button>
                                </form>

                                <!-- Đã check-in nhưng chưa check-out -->
                                <form method="post" asp-action="CheckOut" asp-controller="Attendance">
                                    <input type="hidden" name="staffId" value="@Model.StaffId" />
                                    <input type="hidden" name="shiftId" value="@Model.ShiftId" />
                                    <input type="hidden" name="workshiftId" value="@Model.WorkshiftId" />
                                    <input type="hidden" name="date" value="@Model.Workdate" />
                                    <button class="btn btn-outline-teal px-4 py-2 rounded-pill shadow-sm" type="submit">
                                        <i class="bi bi-box-arrow-right me-1"></i> Check-Out
                                    </button>
                                </form>
                    }
                    else
                    {
                                <!-- Đã check-out -->
                                <div class="alert alert-success text-center px-4 py-2 rounded-pill shadow-sm mb-0">
                                    <i class="bi bi-check-circle me-1"></i> Đã hoàn tất ca làm hôm nay
                                </div>
                    }
                    </div>
            }
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<style>
    body {
        background-color: #E8F5F9;
    }

    .text-teal {
        color: #0097A7 !important;
    }

    .btn-teal {
        background-color: #0097A7;
        color: white;
        border: none;
        transition: all 0.3s ease;
    }

    .btn-teal:hover {
        background-color: #007E8A;
        transform: translateY(-2px);
    }

    .btn-outline-teal {
        color: #0097A7;
        border: 2px solid #0097A7;
        background-color: transparent;
        transition: all 0.3s ease;
    }

    .btn-outline-teal:hover {
        background-color: #0097A7;
        color: white;
        transform: translateY(-2px);
    }

    .info-box {
        background-color: #F8FEFF;
        border-radius: 12px;
        padding: 16px 20px;
        border: 1px solid #D1ECEF;
    }

    .info-item {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px dashed #D9E9EB;
    }

    .info-item:last-child {
        border-bottom: none;
    }

    .info-label {
        font-weight: 600;
        color: #555;
    }

    .info-value {
        color: #333;
        text-align: right;
    }
</style>
